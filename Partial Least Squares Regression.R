
# PARTIAL LEAST SQUARES REGRESSION
# (PLSR)

# Load packages

if (!require (MASS)) {
  install.packages("MASS")
}
library (MASS)
if (!require (plsr)) {
  install.packages("plsr")
}
library (plsr)
if (!require (pls)) {
  install.packages("pls")
}
library (pls)

# You use PLSR when you have a matrix
# of predictor variables and a matrix
# of response variables. In other words,
# you have more than one predictor
# variable and more than one response
# variable. The goal of PLSR is to
# predict all of your response
# variables, given your predictor
# variables.

# Performing PLSR is very similar to,
# but not exactly like, performing
# principal components analysis (PCA)
# on both the predictor and the response
# matrices separately, and then
# regressing the main PCA axes from both
# predictor and response PCAs with each
# other.

# Let's look at this graphically using
# a simple example where we want to
# predict both corn yield (bushels per
# acre) and days to harvest. (Days to
# harvest may not truly respond to
# soil fertility, but let's just pretend
# that it does.)

set.seed(2)
Soil_Phosphorus_Level <- seq_len(20) / 15 + rnorm(20, 35, 5)
Pre_Sidedress_Nitrogen_Test_Results <- seq_len(20) / 10 + rnorm(20, 22, 4)
Yield <- seq_len(20) / 15 + rnorm(20, 140, 5)
Days_to_Harvest <- round(rnorm(20, 65, 4), 0)
Plot <- seq_len(20)
df3 <- data.frame(Plot, Soil_Phosphorus_Level, Pre_Sidedress_Nitrogen_Test_Results, Yield, Days_to_Harvest)
Predictors <- matrix(c(Soil_Phosphorus_Level, Pre_Sidedress_Nitrogen_Test_Results), ncol = 2)
colnames(Predictors) <- c("Soil_Phosphorus_Level", "Pre_Sidedress_Nitrogen_Test_Results")
Responses <- matrix(c(Yield, Days_to_Harvest), ncol = 2)
colnames(Responses) <- c("Yield", "Days_to_Harvest")
View(df3)

# Let's look at the relationships between
# variables. First, let's look only at
# the predictor variables, and then we'll
# look only at the response variables.
# Each point represents a plot.

Predictor_Model <- lm(df3$Soil_Phosphorus_Level ~ df3$Pre_Sidedress_Nitrogen_Test_Results)
Response_Model <- lm(df3$Yield ~ df3$Days_to_Harvest)
par(mfrow = c(1, 2))
plot(df3$Soil_Phosphorus_Level ~ df3$Pre_Sidedress_Nitrogen_Test_Results, main = "Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level")
abline(Predictor_Model, col = 2)
plot(df3$Yield ~ df3$Days_to_Harvest, main = "Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)")
abline(Response_Model, col = 2)

# The lines of best fit here are also
# very similar to the first PCA axes
# for both relationships.

# Let's center our data before we go any
# farther. I'm just going to move the
# origin so that it goes through the
# centroid of the data. To find the
# centroid, we just calculate the means
# of each variable.

Centered_Predictors <- sweep(Predictors, 2, apply(Predictors, 2, mean))
Centered_Responses <- sweep(Responses, 2, apply(Responses, 2, mean))
Centered_Predictor_Model <- lm(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"])
Centered_Response_Model <- lm(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"])
par(mfrow = c(1, 2))
plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level")
abline(Centered_Predictor_Model, col = 2)
plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)")
abline(Centered_Response_Model, col = 2)

# Each point from both plots has an x and
# a y coordinate based on our original
# axes, but they also have new coordinates
# now if we draw perpendicular lines from
# each point to the lines of best fit.
# These new coordinates are essentially
# the PCA scores.

Centered_Predictor_Perpendicular_Slope <- -((coef(Centered_Predictor_Model)[2]) ^ (-1))
Centered_Response_Perpendicular_Slope <- -((coef(Centered_Response_Model)[2]) ^ (-1))
Centered_Predictor_Perpendicular_Intercepts <- NULL
for (i in seq_len(nrow(Centered_Predictors))) {
  Centered_Predictor_Perpendicular_Intercepts[i] <- Centered_Predictors[i, 1] - Centered_Predictor_Perpendicular_Slope * Centered_Predictors[i, 2]
}
Centered_Response_Perpendicular_Intercepts <- NULL
for (i in seq_len(nrow(Predictors))) {
  Centered_Response_Perpendicular_Intercepts[i] <- Centered_Responses[i, 1] - Centered_Response_Perpendicular_Slope * Centered_Responses[i, 2]
}
par(mfrow = c(1, 2), mar = c(5, 4, 4, 2) + 0.1)
plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level")
abline(Centered_Predictor_Model, col = 2)
Predictor_X_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Predictors))) {
  Predictor_X_Coordinates[i] <- (coef(Centered_Predictor_Model)[1] - Centered_Predictor_Perpendicular_Intercepts[i]) / (Centered_Predictor_Perpendicular_Slope - coef(Centered_Predictor_Model)[2])
}
Predictor_Y_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Predictors))) {
  Predictor_Y_Coordinates[i] <- coef(Centered_Predictor_Model)[2] * Predictor_X_Coordinates[i] + coef(Centered_Predictor_Model)[1]
}
for (i in seq_len(nrow(Centered_Predictors))) {
  segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)
}
plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)")
abline(Centered_Response_Model, col = 2)
Response_X_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Responses))) {
  Response_X_Coordinates[i] <- (coef(Centered_Response_Model)[1] - Centered_Response_Perpendicular_Intercepts[i]) / (Centered_Response_Perpendicular_Slope - coef(Centered_Response_Model)[2])
}
Predictor_Y_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Responses))) {
  Predictor_Y_Coordinates[i] <- coef(Centered_Response_Model)[2] * Response_X_Coordinates[i] + coef(Centered_Response_Model)[1]
}
for (i in seq_len(nrow(Centered_Responses))) {
  segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)
}

# These lines don't look exactly
# perpendicular because the x and y
# axes have different scales; you'll
# have to take my word for it.

# I need to introduce some
# terminology here. 'Scores' are the
# new coordinates of each point on
# these new axes. In this graph,
# scores are the locations where
# those dashed lines intersect the
# red line of best fit. 'Loadings'
# are the relative strength each
# variable contributed to these new
# PCA axes. For example, the slopes
# of both of the line of best fit
# from the predictor pgraph is
# relatively perpendicular to the x
# axis (in other words, they're
# flat), so I suspect that 'Pre-
# Sidedress Nitrogen Test Value'
# has a greater loading on this
# line of best fit than 'Soil
# Phosphorus Level' does. In other
# words, the variability along this
# axis is due in larger part to
# nitrogen than it is to phosphorus.

# 'Latent variables' are variables
# that aren't directly measured in
# the study or experiment; latent
# variables are inferred from the
# data after it's collected. Our
# new axis scores, in this case,
# are latent variables.

# Let's now regress the PCA scores
# from the predictor plot with the
# PCA scores from the response plot.

par(mar = c(5, 4, 4, 2) + 0.1)
layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2))
plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level")
abline(Centered_Predictor_Model, col = 2)
Predictor_X_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Predictors))) {
  Predictor_X_Coordinates[i] <- (coef(Centered_Predictor_Model)[1] - Centered_Predictor_Perpendicular_Intercepts[i]) / (Centered_Predictor_Perpendicular_Slope - coef(Centered_Predictor_Model)[2])
}
Predictor_Y_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Predictors))) {
  Predictor_Y_Coordinates[i] <- coef(Centered_Predictor_Model)[2] * Predictor_X_Coordinates[i] + coef(Centered_Predictor_Model)[1]
}
for (i in seq_len(nrow(Centered_Predictors))) {
  segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)
}
plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)")
abline(Centered_Response_Model, col = 2)
Response_X_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Responses))) {
  Response_X_Coordinates[i] <- (coef(Centered_Response_Model)[1] - Centered_Response_Perpendicular_Intercepts[i]) / (Centered_Response_Perpendicular_Slope - coef(Centered_Response_Model)[2])
}
Predictor_Y_Coordinates <- NULL
for (i in seq_len(nrow(Centered_Responses))) {
  Predictor_Y_Coordinates[i] <- coef(Centered_Response_Model)[2] * Response_X_Coordinates[i] + coef(Centered_Response_Model)[1]
}
for (i in seq_len(nrow(Centered_Responses))) {
  segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)
}
Predictor_PCA <- prcomp(Centered_Predictors)
Response_PCA <- prcomp(Centered_Responses)
plot(Response_PCA$x[, "PC1"] ~ Predictor_PCA$x[, "PC1"], xlab = "Predictor PCA Axis 1 Score", ylab = "Response PCA Axis 1 Score", main = "Regressing Predictors and Responses")
abline(lm(Response_PCA$x[, "PC1"] ~ Predictor_PCA$x[, "PC1"]), col = 2)
par(mar = c(1, 1, 1, 1))
plot(0, type = 'n', axes = F, xlab = "", ylab = "")
text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_PCA$x[, "PC1"] ~ Predictor_PCA$x[, "PC1"]))$r.squared, 5)))}))

# This bottom plot is based on these
# data, which are the axis scores
# from both plots:

View(data.frame(Predictor_Axis_Scores = Predictor_PCA$x[, "PC1"], Response_Axis_Scores = Response_PCA$x[, "PC1"]))

# In the bottom plot, each point is
# still a plot; now, though, they
# are plotted in a different space.
# Instead of being plotted in
# predictor or response space, they
# are plotted in PCA axis space.
# This is possible, again, because
# each plot has a score on the new
# PCA axis.

# The relationship between predictor
# and response PCA scores is okay,
# but it isn't great. The final step
# in PLSR is to rotate both of the
# original PCA axis 1s, using the
# centroids of the data as pivot
# points, until the relationship
# in the bottom plot has been
# optimized.

# I owe my entire understanding of
# PLSR to a great series of YouTube
# videos by QualityAndTechnology that
# includes this one, whose animation
# inspired me:
# https://www.youtube.com/watch?v=Qt3Vv5KsnpA

# First, let's generate all the
# information we'll need.

Angle_Function <- function(x, y){
  atan2(y[2], y[1]) - atan2(x[2], x[1]) 
}
New_Predictor_Slopes <- tan((Angle_Function(c(1, 0), c(1, coef(Centered_Predictor_Model)[2]))) * seq(0.25, 1.75, length.out = 6))
New_Response_Slopes <- tan((Angle_Function(c(1, 0), c(1, coef(Centered_Response_Model)[2]))) * seq(0.25, 1.75, length.out = 6))
New_Predictor_Intercepts <- NULL
for (i in seq_len(length(New_Predictor_Slopes))) {
  New_Predictor_Intercepts[i] <- 0
}
New_Response_Intercepts <- NULL
for (i in seq_len(length(New_Response_Slopes))) {
  New_Response_Intercepts[i] <- 0
}
New_Predictor_Perpendicular_Slopes <- -((New_Predictor_Slopes) ^ (-1))
New_Response_Perpendicular_Slopes <- -((New_Response_Slopes) ^ (-1))
New_Predictor_Perpendicular_Intercepts <- lapply(seq_len(length(New_Predictor_Perpendicular_Slopes)), function (x) {
  Intercepts <- sapply(seq_len(nrow(Centered_Predictors)), function (y) {
    Centered_Predictors[y, 1] - New_Predictor_Perpendicular_Slopes[x] * Centered_Predictors[y, 2]
  })
  names(Intercepts) <- NULL
  return (Intercepts)
})
New_Response_Perpendicular_Intercepts <- lapply(seq_len(length(New_Response_Perpendicular_Slopes)), function (x) {
  Intercepts <- sapply(seq_len(nrow(Centered_Responses)), function (y) {
    Centered_Responses[y, 1] - New_Response_Perpendicular_Slopes[x] * Centered_Responses[y, 2]
  })
  names(Intercepts) <- NULL
  return (Intercepts)
})
Predictor_Angles <- lapply(seq_len(length(New_Predictor_Slopes)), function (x) {
  Angles <- sapply(seq_len(nrow(Centered_Predictors)), function (y) {
    Angle_Function(c(New_Predictor_Slopes[x], 1), Centered_Predictors[y, ])
  })
  names(Angles) <- NULL
  return (Angles)
})
Response_Angles <- lapply(seq_len(length(New_Response_Slopes)), function (x) {
  Angles <- sapply(seq_len(nrow(Centered_Responses)), function (y) {
    Angle_Function(c(New_Response_Slopes[x], 1), Centered_Responses[y, ])
  })
  names(Angles) <- NULL
  return (Angles)
})
Predictor_Axis_Scores <- lapply(Predictor_Angles, function (x) {
  Axis_Scores <- sapply(seq_len(length(x)), function (y) {
    -(sqrt(((Centered_Predictors[y, 1]) ^ 2) + ((Centered_Predictors[y, 2]) ^ 2)) * cos(x[y]))
  })
  names(Axis_Scores) <- NULL
  return (Axis_Scores)
})
Response_Axis_Scores <- lapply(Response_Angles, function (x) {
  Axis_Scores <- sapply(seq_len(length(x)), function (y) {
    -(sqrt(((Centered_Responses[y, 1]) ^ 2) + ((Centered_Responses[y, 2]) ^ 2)) * cos(x[y]))
  })
  names(Axis_Scores) <- NULL
  return (Axis_Scores)
})

# Now, let's rotate those axes to
# see how the the bottom plot
# changes.

par(mar = c(5, 4, 4, 2) + 0.1)
plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], type = 'n', axes = F, xlab = "", ylab = "")
Graph_1_Parameters <- par('usr')
Graph_1_Axis_With_Smaller_Range <- NULL
if (diff(c(Graph_1_Parameters[1], Graph_1_Parameters[2])) < diff(c(Graph_1_Parameters[3], Graph_1_Parameters[4]))) {
  Graph_1_Axis_With_Smaller_Range <- "X"
} else if (diff(c(Graph_1_Parameters[1], Graph_1_Parameters[2])) > diff(c(Graph_1_Parameters[3], Graph_1_Parameters[4]))) {
  Graph_1_Axis_With_Smaller_Range <- "Y"
}
Graph_1_X_Limits <- NULL
Graph_1_Y_Limits <- NULL
if (Graph_1_Axis_With_Smaller_Range == "X") {
  Graph_1_X_Limits <- c(Graph_1_Parameters[1] - ((diff(Graph_1_Parameters[3:4]) - diff(Graph_1_Parameters[1:2])) / 2), Graph_1_Parameters[2] + ((diff(Graph_1_Parameters[3:4]) - diff(Graph_1_Parameters[1:2])) / 2))
  Graph_1_Y_Limits <- Graph_1_Parameters[3:4]
} else if (Graph_1_Axis_With_Smaller_Range == "Y") {
  Graph_1_X_Limits <- Graph_1_Parameters[1:2]
  Graph_1_Y_Limits <- c(Graph_1_Parameters[3] - ((diff(Graph_1_Parameters[1:2]) - diff(Graph_1_Parameters[3:4])) / 2), Graph_1_Parameters[4] + ((diff(Graph_1_Parameters[1:2]) - diff(Graph_1_Parameters[3:4])) / 2))
}
plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], type = 'n', axes = F, xlab = "", ylab = "")
Graph_2_Parameters <- par('usr')
Graph_2_Axis_With_Smaller_Range <- NULL
if (diff(c(Graph_2_Parameters[1], Graph_2_Parameters[2])) < diff(c(Graph_2_Parameters[3], Graph_2_Parameters[4]))) {
  Graph_2_Axis_With_Smaller_Range <- "X"
} else if (diff(c(Graph_2_Parameters[1], Graph_2_Parameters[2])) > diff(c(Graph_2_Parameters[3], Graph_2_Parameters[4]))) {
  Graph_2_Axis_With_Smaller_Range <- "Y"
}
Graph_2_X_Limits <- NULL
Graph_2_Y_Limits <- NULL
if (Graph_2_Axis_With_Smaller_Range == "X") {
  Graph_2_X_Limits <- c(Graph_2_Parameters[1] - ((diff(Graph_2_Parameters[3:4]) - diff(Graph_2_Parameters[1:2])) / 2), Graph_2_Parameters[2] + ((diff(Graph_2_Parameters[3:4]) - diff(Graph_2_Parameters[1:2])) / 2))
  Graph_2_Y_Limits <- Graph_2_Parameters[3:4]
} else if (Graph_2_Axis_With_Smaller_Range == "Y") {
  Graph_2_X_Limits <- Graph_2_Parameters[1:2]
  Graph_2_Y_Limits <- c(Graph_2_Parameters[3] - ((diff(Graph_2_Parameters[1:2]) - diff(Graph_2_Parameters[3:4])) / 2), Graph_2_Parameters[4] + ((diff(Graph_2_Parameters[1:2]) - diff(Graph_2_Parameters[3:4])) / 2))
}
Graph_3_Parameters <- list()
k <- 1
for (i in 1:6) {
  for (j in 1:6) {
    plot(Response_Axis_Scores[[i]] ~ Predictor_Axis_Scores[[j]], type = 'n', axes = F, xlab = "", ylab = "")
    Graph_3_Parameters[[k]] <- par('usr')
    k <- k + 1
  }
}
Graph_3_X_Limits <- c(min(sapply(Graph_3_Parameters, function (x) {x[1]})), max(sapply(Graph_3_Parameters, function (x) {x[2]})))
Graph_3_Y_Limits <- c(min(sapply(Graph_3_Parameters, function (x) {x[3]})), max(sapply(Graph_3_Parameters, function (x) {x[4]})))

Predictor_Iteration <- 1; Response_Iteration <- 1; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 1; Response_Iteration <- 2; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 1; Response_Iteration <- 3; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 1; Response_Iteration <- 4; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 1; Response_Iteration <- 5; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 1; Response_Iteration <- 6; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 2; Response_Iteration <- 6; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 2; Response_Iteration <- 5; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 2; Response_Iteration <- 4; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 2; Response_Iteration <- 3; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 2; Response_Iteration <- 2; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 2; Response_Iteration <- 1; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 3; Response_Iteration <- 1; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 3; Response_Iteration <- 2; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 3; Response_Iteration <- 3; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 3; Response_Iteration <- 4; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 3; Response_Iteration <- 5; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 3; Response_Iteration <- 6; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 4; Response_Iteration <- 6; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 4; Response_Iteration <- 5; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 4; Response_Iteration <- 4; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 4; Response_Iteration <- 3; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 4; Response_Iteration <- 2; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 4; Response_Iteration <- 1; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 5; Response_Iteration <- 1; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 5; Response_Iteration <- 2; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 5; Response_Iteration <- 3; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 5; Response_Iteration <- 4; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 5; Response_Iteration <- 5; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 5; Response_Iteration <- 6; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 6; Response_Iteration <- 6; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 6; Response_Iteration <- 5; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 6; Response_Iteration <- 4; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 6; Response_Iteration <- 3; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 6; Response_Iteration <- 2; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))
Predictor_Iteration <- 6; Response_Iteration <- 1; par(mar = c(5, 4, 4, 2) + 0.1); layout(matrix(c(1, 1, 2, 2, 0, 3, 3, 4), byrow = T, nrow = 2)); plot(Centered_Predictors[, "Soil_Phosphorus_Level"] ~ Centered_Predictors[, "Pre_Sidedress_Nitrogen_Test_Results"], main = "Centered Predictor Variables", xlab = "Pre-Sidedress Nitrogen Test Value", ylab = "Soil Phosphorus Level", xlim = Graph_1_X_Limits, ylim = Graph_1_Y_Limits); abline(a = New_Predictor_Intercepts[Predictor_Iteration], b = New_Predictor_Slopes[Predictor_Iteration], col = 2); Predictor_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_X_Coordinates[i] <- (New_Predictor_Slopes[Predictor_Iteration] - New_Predictor_Perpendicular_Intercepts[[Predictor_Iteration]][i]) / (New_Predictor_Perpendicular_Slopes[Predictor_Iteration] - New_Predictor_Slopes[Predictor_Iteration])}; Predictor_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Predictors))) {Predictor_Y_Coordinates[i] <- New_Predictor_Slopes[Predictor_Iteration] * Predictor_X_Coordinates[i] + New_Predictor_Intercepts[Predictor_Iteration]}; for (i in seq_len(nrow(Centered_Predictors))) {segments(Centered_Predictors[i, 2], Centered_Predictors[i, 1], Predictor_X_Coordinates[i], Predictor_Y_Coordinates[i], lty = 2)}; plot(Centered_Responses[, "Yield"] ~ Centered_Responses[, "Days_to_Harvest"], main = "Centered Response Variables", xlab = "Days to Harvest", ylab = "Yield (bushels per acre)", xlim = Graph_2_X_Limits, ylim = Graph_2_Y_Limits); abline(a = New_Response_Intercepts[Response_Iteration], b = New_Response_Slopes[Response_Iteration], col = 2); Response_X_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_X_Coordinates[i] <- (New_Response_Slopes[Response_Iteration] - New_Response_Perpendicular_Intercepts[[Response_Iteration]][i]) / (New_Response_Perpendicular_Slopes[Response_Iteration] - New_Response_Slopes[Response_Iteration])}; Response_Y_Coordinates <- NULL; for (i in seq_len(nrow(Centered_Responses))) {Response_Y_Coordinates[i] <- New_Response_Slopes[Response_Iteration] * Response_X_Coordinates[i] + New_Response_Intercepts[Response_Iteration]}; for (i in seq_len(nrow(Centered_Responses))) {segments(Centered_Responses[i, 2], Centered_Responses[i, 1], Response_X_Coordinates[i], Response_Y_Coordinates[i], lty = 2)}; plot(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]], xlab = "Predictor Axis Score", ylab = "Response Axis Score", main = "Regressing Predictors and Responses", xlim = Graph_3_X_Limits, ylim = Graph_3_Y_Limits); abline(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]), col = 2); par(mar = c(1, 1, 1, 1)); plot(0, type = 'n', axes = F, xlab = "", ylab = ""); text(1, 0, bquote({r^2 == .(as.character(round(summary(lm(Response_Axis_Scores[[Response_Iteration]] ~ Predictor_Axis_Scores[[Predictor_Iteration]]))$r.squared, 5)))}))

# The r-squared value from the original
# PLSR plot, where we used the first
# PCA axes from both the predictors and
# the responses, was 0.00588, so these
# plots are a huge improvement.

# When you have more than two predictor
# and response variables, predictor and
# response loadings are generated in
# pairs. In other words, the first
# loading from the predictor variables
# is used to predict the first loading
# from the response variables, the
# second loading from the predictor
# variables is used to predict the
# second loading from the response
# variables, etc. Since you know the
# scores each variable has on each
# loading, you now have enough
# information to predict response
# variables.

# Since our class's data doesn't really
# have quantitative predictor variables,
# I'm going to use the `Cars93` data
# frame from the `MASS` package to lead
# you through an example.

View(Cars93)

# Response variables inlude `MPG.city`
# and `MPG.highway`; predictor variables
# include `Weight`, `EngineSize`, and
# `Horsepower`. Let's use these 5
# variables (2 response variables and
# 3 predictor variables) in our
# analysis.

# I'm going to use the `pls` function in
# the `plsr` package to perform this
# analysis.

PLSR_Output <- pls(as.matrix(Cars93[, c("Weight", "EngineSize", "Horsepower")]), as.matrix(Cars93[, c("MPG.highway", "MPG.city")]))
summary(PLSR_Output)

# What do these things mean?

Response_Variable_Loadings <- PLSR_Output$decomposition$U
rownames(Response_Variable_Loadings) <- c("MPG.highway", "MPG.city")
colnames(Response_Variable_Loadings) <- c("PLS1", "PLS2")
Predictor_Variable_Loadings <- PLSR_Output$decomposition$V
colnames(Predictor_Variable_Loadings) <- c("PLS1", "PLS2")
Response_Variable_Loadings
Predictor_Variable_Loadings

# The columns in these two matrices
# represent the latent variables from
# PLSR - in other words, they
# represent the lines of best fit from
# the bottom plots from our exercise.

# The rows represent our predictor and
# response variables, and each entry is
# the corresponding loading.

p_Values <- PLSR_Output$permutation$p_values
names(p_Values) <- c("PLS1", "PLS2")
p_Values

# I think these p values correspond to
# the strength of the relationship
# between the nth predictor component
# and the nth response component. Like
# in multiple linear regression, we can
# use these p values to help figure out
# which latent variables, or PLSR
# components, are important. In this
# case, only the first is important.
# (I still don't fully understand how
# these p values are calculated, but
# it's evident from what I've read that
# they can be used to select which
# components are important.)

# The real purpose of PLSR, though, is to
# predict. Let's re-run PLSR with the
# `Cars93` data, but let's leave out the
# last 5 rows. We'll use the resulting
# model to see how well we can predict
# the observations from the last 5 rows.

# To generate predictions, I'm going to
# use a different PLSR function (`plsr`)
# that is in a different package (`pls`).

PLSR_Output <- plsr(as.matrix(Cars93[seq_len(nrow(Cars93) - 5), c("MPG.highway", "MPG.city")]) ~ as.matrix(Cars93[seq_len(nrow(Cars93) - 5), c("Weight", "EngineSize", "Horsepower")]))
summary(PLSR_Output)
predict(PLSR_Output, as.matrix(Cars93[(nrow(Cars93) - 4):nrow(Cars93), c("Weight", "EngineSize", "Horsepower")]))

# How good are these predictions? Let's
# compare them with the actual values.

Cars93[(nrow(Cars93) - 4):nrow(Cars93), c("MPG.highway", "MPG.city")]
predict(PLSR_Output, as.matrix(Cars93[(nrow(Cars93) - 4):nrow(Cars93), c("Weight", "EngineSize", "Horsepower")]))
